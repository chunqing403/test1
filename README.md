flowchart LR
    A[开始]
    B[选择宏环大小]
    C[构建线性聚甘氨酸骨架]
    D[设置N-to-C端距离、角度和二面角约束]
    E[随机选择锚定残基]
    F[选择支点残基（3个）]
    G[锚定残基随机赋二面角]
    H[支点残基从拉曼表随机赋二面角]
    I[使用GeneralizedKIC识别环肽]
    J1[非锚定非支点残基随机赋二面角（拉曼表）]
    J2[支点残基用运动学闭合算法计算二面角]
    K{环肽闭合条件满足？}
    L1[是，选择最低能量的GeneralizedKIC环肽]
    L2[否，返回重新赋角度循环]
    M[使用Rosetta FastDesign设计侧链]
    N[不满足骨架NH氢键的氨基酸N-甲基化]
    O[设计模型过滤]
    P[simple_cycpep_predict结构预测]
    Q[选择低能量构象作为最终结果]
    R[结束]

    A --> B --> C --> D --> E --> F --> G --> H --> I
    I --> J1
    I --> J2
    J1 --> K
    J2 --> K
    K -- 否 --> L2 --> G
    K -- 是 --> L1 --> M --> N --> O --> P --> Q --> R
